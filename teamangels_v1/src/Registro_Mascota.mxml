<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
			   xmlns:s="library://ns.adobe.com/flex/spark"
			   xmlns:mx="library://ns.adobe.com/flex/mx"
			   xmlns:Formularios="Formularios.*"
			   xmlns:mascotasservice="services.mascotasservice.*"
			   minWidth="1024" minHeight="768"
			   creationComplete="application1_creationCompleteHandler(event)">
	<fx:Script>
		<![CDATA[
			import Formularios.Registro_Cliente;
			
			import mx.controls.Alert;
			import mx.events.FlexEvent;
			import mx.events.ValidationResultEvent;
			import mx.rpc.events.ResultEvent;
			
			import valueObjects.Mascotas;
			[Bindable] private  var Fecha:Date = new Date();
			
			//SE DESACTIVA Y NO SE VISUALIZA LOS SIGUIENTES COMPONENTE AL INICIALIZAR
			protected function application1_creationCompleteHandler(event:FlexEvent):void
			{

				Rbtn_Documento.enabled=false;
				Rbtn_Documento.visible=false;
				Rbtn_Mascota.enabled=false;
				Rbtn_Mascota.visible=false;
				Rbtn_Propietario.enabled=false;
				Rbtn_Propietario.visible=false;
				Btn_Buscar_Documento.enabled=false;
				Btn_Buscar_Documento.visible=false;
				Btn_Buscar_Propietario.enabled=false;
				Btn_Buscar_Propietario.visible=false;
				Btn_Buscar_Mascota.enabled=false;
				Btn_Buscar_Mascota.visible=false;
				Txt_Buscar_Documento.enabled=false;
				Txt_Buscar_Documento.visible=false;
				Txt_Buscar_Propietario.enabled=false;
				Txt_Buscar_Propietario.visible=false;
				Txt_Buscar_Mascota.enabled=false;
				Txt_Buscar_Mascota.visible=false;
				Lst_Buscar_Documento.enabled=false;
				Lst_Buscar_Documento.visible=false;
				Lst_Buscar_Propietario.enabled=false;
				Lst_Buscar_Propietario.visible=false;
				Lst_Buscar_Mascota.enabled=false;
				Lst_Buscar_Mascota.visible=false;
				
				registro_mascota.Txt_Documento.editable=false;
				registro_mascota.Txt_Nombres_Y_Apellidos.editable=false;
				registro_mascota.Txt_Nombre_Mascota.editable=false;
				registro_mascota.Txt_Id_Chip.editable=false;
				registro_mascota.Ddl_Especie.enabled=false;
				registro_mascota.Ddl_Raza.enabled=false;
				registro_mascota.Ddl_Pelaje.enabled=false;
				registro_mascota.Txt_Color.editable=false;
				registro_mascota.Ddl_Tamano.enabled=false;
				registro_mascota.Ddl_Genero.enabled=false;
				registro_mascota.Txt_Peso.editable=false;
				registro_mascota.Ddl_Estado_Reproductivo.enabled=false;
				registro_mascota.Ddl_Temperamento.enabled=false;
				registro_mascota.Ddl_Dia.enabled=false;
				registro_mascota.Ddl_Mes.enabled=false;
				registro_mascota.Txt_Ano.editable=false;
				registro_mascota.Txt_Edad_Dias.editable=false;
				registro_mascota.Txt_Edad_Meses.editable=false;
				registro_mascota.Edad_Anos.editable=false;
				registro_mascota.Ddl_Tipo_Alimentacion.enabled=false;
				registro_mascota.Ddl_Marca.enabled=false;
				registro_mascota.Txt_Descripcion_Marca.editable=false;
				registro_mascota.Ddl_Referencia.enabled=false;
				registro_mascota.Txt_Descripcion_Referencia.editable=false;
				registro_mascota.Txta_Senales_Particulares.editable=false;
				registro_mascota.Txta_Observaciones.editable=false;
				
			}
			
			//SE ACTIVAN Y SE VISUALIZAN LOS SIGUIENTES COMPONENTES AL DAR CLICK EN BUSCAR
			protected function Btn_Buscar_clickHandler(event:MouseEvent):void
			{
				
				Rbtn_Documento.enabled=true;
				Rbtn_Documento.visible=true;
				Rbtn_Mascota.enabled=true;
				Rbtn_Mascota.visible=true;
				Rbtn_Propietario.enabled=true;
				Rbtn_Propietario.visible=true;
			}
			
			//SE ACTIVAN Y DESACTIVAN LOS SIGUIENTES COMPONENTES DEPENDIENDO DEL ALUE QUE ESCOJAN
			protected function Buscar_changeHandler(event:Event):void
			{
				if(Buscar.selectedValue == "Doc"){
					
					Btn_Buscar_Documento.enabled=true;
					Btn_Buscar_Documento.visible=true;
					Txt_Buscar_Documento.enabled=true;
					Txt_Buscar_Documento.visible=true;
					Lst_Buscar_Documento.enabled=true;
					Lst_Buscar_Documento.visible=true;
					Lst_Buscar_Propietario.enabled=true;
					Lst_Buscar_Propietario.visible=true;
					Lst_Buscar_Mascota.enabled=true;
					Lst_Buscar_Mascota.visible=true;
					
				}else{
					
					
					Btn_Buscar_Documento.enabled=false;
					Btn_Buscar_Documento.visible=false;
					Txt_Buscar_Documento.enabled=false;
					Txt_Buscar_Documento.visible=false;
					
				}
			
				if(Buscar.selectedValue =="Pro"){
					
					Btn_Buscar_Propietario.enabled=true;
					Btn_Buscar_Propietario.visible=true;
					Txt_Buscar_Propietario.enabled=true;
					Txt_Buscar_Propietario.visible=true;
					Lst_Buscar_Documento.enabled=true;
					Lst_Buscar_Documento.visible=true;
					Lst_Buscar_Propietario.enabled=true;
					Lst_Buscar_Propietario.visible=true;
					Lst_Buscar_Mascota.enabled=true;
					Lst_Buscar_Mascota.visible=true;
					
					
				}else{
					
					Btn_Buscar_Propietario.enabled=false;
					Btn_Buscar_Propietario.visible=false;
					Txt_Buscar_Propietario.enabled=false;
					Txt_Buscar_Propietario.visible=false;
				
				}
				
				
				if(Buscar.selectedValue =="Mas"){
					
					Btn_Buscar_Mascota.enabled=true;
					Btn_Buscar_Mascota.visible=true;
					Txt_Buscar_Mascota.enabled=true;
					Txt_Buscar_Mascota.visible=true;
					Lst_Buscar_Documento.enabled=true;
					Lst_Buscar_Documento.visible=true;
					Lst_Buscar_Propietario.enabled=true;
					Lst_Buscar_Propietario.visible=true;
					Lst_Buscar_Mascota.enabled=true;
					Lst_Buscar_Mascota.visible=true;
					
				}else{
					Btn_Buscar_Mascota.enabled=false;
					Btn_Buscar_Mascota.visible=false;
					Txt_Buscar_Mascota.enabled=false;
					Txt_Buscar_Mascota.visible=false;
					
				}
			}
			
			//LIMPIA LOS CAMPOS
			private function Limpiar():void{	
				
			registro_mascota.Txt_Documento.text="";
			registro_mascota.Txt_Documento.errorString="";
			registro_mascota.Txt_Nombres_Y_Apellidos.text="";
			registro_mascota.Txt_Nombres_Y_Apellidos.errorString="";
			registro_mascota.Txt_Nombre_Mascota.text="";
			registro_mascota.Txt_Nombre_Mascota.errorString="";
			registro_mascota.Txt_Id_Chip.text="";
			registro_mascota.Txt_Id_Chip.errorString="";
			registro_mascota.Ddl_Especie.selectedIndex=-1;
			registro_mascota.Ddl_Especie.errorString="";
			registro_mascota.Ddl_Raza.selectedIndex=-1;
			registro_mascota.Ddl_Raza.errorString="";
			registro_mascota.Ddl_Pelaje.selectedIndex=-1;
			registro_mascota.Ddl_Pelaje.errorString="";
			registro_mascota.Txt_Color.text="";
			registro_mascota.Txt_Color.errorString="";
			registro_mascota.Ddl_Tamano.selectedIndex=-1;
			registro_mascota.Ddl_Tamano.errorString="";
			registro_mascota.Ddl_Genero.selectedIndex=-1;
			registro_mascota.Ddl_Genero.errorString="";
			registro_mascota.Txt_Peso.text="";
			registro_mascota.Txt_Peso.errorString="";
			registro_mascota.Ddl_Estado_Reproductivo.selectedIndex=-1;
			registro_mascota.Ddl_Estado_Reproductivo.errorString="";
			registro_mascota.Ddl_Temperamento.selectedIndex=-1;
			registro_mascota.Ddl_Temperamento.errorString="";
			registro_mascota.Ddl_Dia.selectedIndex=-1;
			registro_mascota.Ddl_Dia.errorString="";
			registro_mascota.Ddl_Mes.selectedIndex=-1;
			registro_mascota.Ddl_Mes.errorString="";
			registro_mascota.Txt_Ano.text="";
			registro_mascota.Txt_Ano.errorString="";
			registro_mascota.Txt_Edad_Dias.text="";
			registro_mascota.Txt_Edad_Dias.errorString="";
			registro_mascota.Txt_Edad_Meses.text="";
			registro_mascota.Txt_Edad_Meses.errorString="";
			registro_mascota.Edad_Anos.text="";
			registro_mascota.Edad_Anos.errorString="";
			registro_mascota.Ddl_Tipo_Alimentacion.selectedIndex=-1;
			registro_mascota.Ddl_Tipo_Alimentacion.errorString="";
			registro_mascota.Ddl_Marca.selectedIndex=-1;
			registro_mascota.Ddl_Marca.errorString="";
			registro_mascota.Txt_Descripcion_Marca.text="";
			registro_mascota.Txt_Descripcion_Marca.errorString="";
			registro_mascota.Ddl_Referencia.selectedIndex=-1;
			registro_mascota.Ddl_Referencia.errorString="";
			registro_mascota.Txt_Descripcion_Referencia.text="";
			registro_mascota.Txt_Descripcion_Referencia.errorString="";
			registro_mascota.Txta_Senales_Particulares.text="";
			registro_mascota.Txta_Senales_Particulares.errorString="";
			registro_mascota.Txta_Observaciones.text="";
			registro_mascota.Txta_Observaciones.errorString="";
		
			}
			
			
			//FUNCION DE GUARDADO DE LOS REGISTROS
			protected function Btn_Guardar_clickHandler(event:MouseEvent):void
			{
				
				var Reg:Mascotas = new Mascotas();
				
			    Reg.Documento_Propietario = "";
				Reg.Propietario="";
				Reg.Nombre_Mascota = registro_mascota.Txt_Nombre_Mascota.text;
				Reg.Id_Chif = registro_mascota.Txt_Id_Chip.text;
				Reg.Id_Especie = registro_mascota.Ddl_Especie.selectedItem.Id_Especie;
				Reg.Especie = registro_mascota.Ddl_Especie.selectedItem.Especie;
				Reg.Id_Raza = registro_mascota.Ddl_Raza.selectedItem.Id_Raza;
				Reg.Raza =  registro_mascota.Ddl_Raza.selectedItem.Raza;
				Reg.Pelaje = registro_mascota.Ddl_Pelaje.selectedItem;
				Reg.Color = registro_mascota.Txt_Color.text;
				Reg.Tamano = registro_mascota.Ddl_Tamano.selectedItem;
				Reg.Genero = registro_mascota.Ddl_Genero.selectedItem;
				Reg.Peso = registro_mascota.Txt_Peso.text;
				Reg.Estado_Reproductivo = registro_mascota.Ddl_Estado_Reproductivo.selectedItem;
				Reg.Temperamento = registro_mascota.Ddl_Temperamento.selectedItem;
				Reg.Fecha_Nacimiento = Data_Model_Mascotas.Fecha_Nacimiento;
				Reg.Edad_Dias = registro_mascota.Txt_Edad_Dias.text;	
				Reg.Edad_Meses = registro_mascota.Txt_Edad_Meses.text;
				Reg.Edad_Anos = registro_mascota.Edad_Anos.text;
				Reg.Tipo_Alimentacion = registro_mascota.Ddl_Tipo_Alimentacion.selectedItem;
				Reg.Marca = "";
				Reg.Descripcion_Marca = registro_mascota.Txt_Descripcion_Marca.text;
				Reg.Referencia = "";
				Reg.Descripcion_Referencia = registro_mascota.Txt_Descripcion_Referencia.text;
				Reg.Senales_Particulares = registro_mascota.Txta_Senales_Particulares.text;
				Reg.Observaciones = registro_mascota.Txta_Observaciones.text;
				Reg.Fecha = Fecha;
				Reg.Usuario = "laura"
				
				createMascotasResult.token = mascotasService.createMascotas(Reg);
				mascotasService.commit();
				
				
				
			}
			
			
			//RESPONDE LO DEL CREATE
			protected function createMascotasResult_resultHandler(event:ResultEvent):void
			{
				Limpiar();
			}
			
			//ACTIVA LOS CAMPOS PARA UN NUEVO REGISTRO
			protected function Btn_Nuevo_clickHandler(event:MouseEvent):void
			{
				registro_mascota.Txt_Nombre_Mascota.editable=true;
				registro_mascota.Txt_Id_Chip.editable=true;
				registro_mascota.Ddl_Especie.enabled=true;
				registro_mascota.Ddl_Raza.enabled=true;
				registro_mascota.Ddl_Pelaje.enabled=true;
				registro_mascota.Txt_Color.editable=true;
				registro_mascota.Ddl_Tamano.enabled=true;
				registro_mascota.Ddl_Genero.enabled=true;
				registro_mascota.Txt_Peso.editable=true;
				registro_mascota.Ddl_Estado_Reproductivo.enabled=true;
				registro_mascota.Ddl_Temperamento.enabled=true;
				registro_mascota.Ddl_Dia.enabled=true;
				registro_mascota.Ddl_Mes.enabled=true;
				registro_mascota.Txt_Ano.editable=true;
				registro_mascota.Txt_Edad_Dias.editable=true;
				registro_mascota.Txt_Edad_Meses.editable=true;
				registro_mascota.Edad_Anos.editable=true;
				registro_mascota.Ddl_Tipo_Alimentacion.enabled=true;
				registro_mascota.Ddl_Marca.enabled=true;
				registro_mascota.Txt_Descripcion_Marca.editable=true;
				registro_mascota.Ddl_Referencia.enabled=true;
				registro_mascota.Txt_Descripcion_Referencia.editable=true;
				registro_mascota.Txta_Senales_Particulares.editable=true;
				registro_mascota.Txta_Observaciones.editable=true;
				
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<s:RadioButtonGroup id="Buscar" change="Buscar_changeHandler(event)"/>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
		
		
		<fx:Model id="Data_Model_Mascotas">
			
		<Data>
			<Id>{}</Id>
			
			<Fecha_Nacimiento>{registro_mascota.Ddl_Dia.selectedItem}-{registro_mascota.Ddl_Mes.selectedItem}-{registro_mascota.Txt_Ano.text}</Fecha_Nacimiento>
			
		</Data>
		</fx:Model>
		
		<s:CallResponder id="createMascotasResult" result="createMascotasResult_resultHandler(event)"/>
		<mascotasservice:MascotasService id="mascotasService"
										 fault="Alert.show(event.fault.faultString + '\n' + event.fault.faultDetail)"
										 showBusyCursor="true"/>
		
		
		
	</fx:Declarations>
	
	
	<s:BorderContainer  width="90%" height="100%">
		
		<s:HGroup x="550" y="735">
			
			<s:Button id="Btn_Guardar" label="Guardar" click="Btn_Guardar_clickHandler(event)"/>
				
		</s:HGroup>
	
		<s:DataGrid id="dataGrid" x="80" y="763" width="1403" height="109">
			<s:columns>
				<s:ArrayList>
					<!--<s:GridColumn dataField="Id_Servicio" headerText="Id_Servicio"></s:GridColumn>-->
					<s:GridColumn  width="260" dataField="Propietario" headerText="Propietario"></s:GridColumn>
					<s:GridColumn  width="400" dataField="Mascota" headerText="Mascota"></s:GridColumn>
					<s:GridColumn  width="260"   dataField="Id_Chip" headerText="Id Chip"></s:GridColumn>
					
					<s:GridColumn  width="260" dataField="Especie" headerText="Especie"></s:GridColumn>
					<s:GridColumn  width="400" dataField="Raza" headerText="Raza"></s:GridColumn>
					<s:GridColumn  width="260"  dataField="Pelaje" headerText="Pelaje"></s:GridColumn>
					
					<s:GridColumn  width="260" dataField="Color" headerText="Color"></s:GridColumn>
					<s:GridColumn  width="400" dataField="Tamaño" headerText="Tamaño"></s:GridColumn>
					<s:GridColumn  width="260"  dataField="Genero" headerText="Genero"></s:GridColumn>
					
					<s:GridColumn  width="260" dataField="Peso" headerText="Peso"></s:GridColumn>
					<s:GridColumn  width="400" dataField="Estado_Reproductivo" headerText="Estado Reproductivo"></s:GridColumn>
					<s:GridColumn  width="260"  dataField="Fecha_Nacimiento" headerText="Fecha Nacimiento"></s:GridColumn>
					<s:GridColumn  width="260"  dataField="Edad" headerText="Edad"></s:GridColumn>
				
					<s:GridColumn  width="260" dataField="Tipo_Alimentacion" headerText="Tipo Alimentacion"></s:GridColumn>
					<s:GridColumn  width="400" dataField="Marca" headerText="Marca"></s:GridColumn>
					<s:GridColumn  width="260" dataField="Descripcion_Marca" headerText="Descripcion Marca"></s:GridColumn>
					<s:GridColumn  width="260" dataField="Referencia" headerText="Referencia"></s:GridColumn>
					
					<s:GridColumn  width="260" dataField="Descripcion_Referencia" headerText="Descripcion Referencia"></s:GridColumn>
					<s:GridColumn  width="400" dataField="Señales_Particulares" headerText="Señales Particulares"></s:GridColumn>
					<s:GridColumn  width="260" dataField="Observaciones" headerText="Observaciones">
					</s:GridColumn>
				</s:ArrayList>
			</s:columns>
			<s:typicalItem>
				
			</s:typicalItem>
			
		</s:DataGrid>
		<s:Form x="45" y="60" width="50%" height="100%">
			<Formularios:Registro_Mascota id="registro_mascota">		
			</Formularios:Registro_Mascota>
			
			
		</s:Form>
		<s:List id="Lst_Buscar_Propietario" x="1243" y="124" width="249" height="605"></s:List>
		<s:List id="Lst_Buscar_Documento" x="1099" y="123" width="142" height="606"></s:List>
		<s:Button id="Btn_Buscar_Documento" x="1099" y="94" label="Buscar"/>
		<s:Button id="Btn_Buscar_Propietario" x="1099" y="94" label="Buscar"/>
		<s:Button id="Btn_Buscar_Mascota" x="1099" y="94" label="Buscar"/>
		
		<s:HGroup x="80" y="15" width="200" height="25">
			<s:Button id="Btn_Nuevo" label="Nuevo" click="Btn_Nuevo_clickHandler(event)"/>
			<s:Button id="Btn_Editar" label="Editar"/>
			<s:Button id="Btn_Buscar" label="Buscar" click="Btn_Buscar_clickHandler(event)"/>
		</s:HGroup>
		
		
	</s:BorderContainer>
	<s:List id="Lst_Buscar_Mascota" x="1495" y="125" width="142" height="606"></s:List>

	<s:HGroup x="1102" y="53" width="338" height="20">
		<s:RadioButton id="Rbtn_Documento" label="Documento" groupName="Buscar" value="Doc"/>
		<s:RadioButton id="Rbtn_Propietario" label="Propietario" groupName="Buscar" value="Pro"/>
		<s:RadioButton id="Rbtn_Mascota" x="1290" y="53" label="Mascota" groupName="Buscar" value="Mas"/>
	</s:HGroup>
	<s:TextInput id="Txt_Buscar_Documento" x="1172" y="95" width="465" prompt="DOCUMENTO"/>
	<s:TextInput id="Txt_Buscar_Propietario" x="1172" y="95" width="465" prompt="PROPIETARIO"/>
	
	<s:TextInput id="Txt_Buscar_Mascota" x="1172" y="95" width="465" prompt="MASCOTA"/>
	
</s:Application>
